<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#f5f5f5">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.json">
    <title>SmartFIT Golf Grip Survey</title>
    <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        html, body {
            height: 100%;
            width: 100vw;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: #f5f5f5;
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        body {
            min-height: 100dvh;
            max-height: 100dvh;
            height: 100dvh;
            width: 100vw;
            overflow: hidden !important;
            display: flex;
            align-items: stretch;
            justify-content: center;
            padding: 0;
            margin: 0;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .survey-container {
            width: 100vw;
            max-width: 100vw;
            height: 100dvh;
            min-height: 100dvh;
            margin: 0;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
            display: flex;
            align-items: flex-start;
            justify-content: center;
            background: #f5f5f5;
            box-sizing: border-box;
        }
        .survey-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 20px;
            height: calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 20px);
            max-height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            width: 100%;
            max-width: 500px;
            margin: auto;
            box-sizing: border-box;
        }
        /* Prevent scroll bounce and all scrolling */
        ::-webkit-scrollbar { display: none; }
        * { overscroll-behavior: none; }
        /* iOS tap feedback */
        button, .option-button, .nav-button, .begin-button, .slot-option {
            -webkit-tap-highlight-color: rgba(79,209,197,0.08) !important;
            transition: background 0.15s, color 0.15s, box-shadow 0.15s;
        }
        button:active, .option-button:active, .nav-button:active, .begin-button:active, .slot-option:active {
            background: #f0fdfa !important;
            color: #319795 !important;
        }
        /* Ensure all interactive elements are large enough */
        .option-button, .nav-button, .begin-button, .slot-option {
            min-height: 48px;
            min-width: 48px;
            font-size: 1.1rem;
        }
        /* Header */
        .survey-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-shrink: 0;
            min-height: 44px; /* iOS minimum touch target */
            padding-top: 0;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.25rem;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .logo span:nth-child(1) {
            color: #1a1a1a;
        }

        .logo span:nth-child(2) {
            color: #1a1a1a;
        }

        .logo span:nth-child(3) {
            color: #4fd1c5;
        }

        .menu-icon {
            font-size: 1.25rem;
            color: #cbd5e0;
            cursor: pointer;
            min-width: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Progress indicator */
        .progress-dots {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-bottom: 20px;
            flex-shrink: 0;
        }

        .progress-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: #e2e8f0;
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background-color: #4fd1c5;
            width: 20px;
            border-radius: 3px;
        }

        /* Question styling */
        .question-number {
            color: #4fd1c5;
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 15px;
            line-height: 1;
        }

        .question-text {
            font-size: 6.25rem;
            font-weight: 600;
            color: #2d3748;
            text-align: center;
            margin-bottom: 25px;
            line-height: 1.3;
        }

        .section-intro {
            background-color: #e6fffa;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .section-intro h2 {
            color: #4fd1c5;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .section-intro p {
            color: #4a5568;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Welcome page specific styles */
        .welcome-page {
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            height: 100%;
        }

        .welcome-content h1 {
            font-size: 2.25rem;
            font-weight: 600;
            color: #4fd1c5;
            margin-bottom: 20px;
            line-height: 1.2;
            max-width: 400px;
        }

        .welcome-content p {
            font-size: 1.125rem;
            color: #2d3748;
            margin-bottom: 30px;
            line-height: 1.5;
            max-width: 400px;
            font-weight: 400;
        }

        .begin-button {
            background-color: #60a5fa;
            color: white;
            padding: 15px 50px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 4px 15px rgba(96, 165, 250, 0.3);
            min-height: 44px;
            touch-action: manipulation;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }

        .begin-button:hover {
            background-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(96, 165, 250, 0.4);
        }

        .begin-button:active {
            transform: translateY(0);
        }

        /* Golf graphic */
        .golf-graphic {
            position: absolute;
            right: -80px;
            bottom: -40px;
            width: 300px;
            height: 300px;
            opacity: 0.3;
            z-index: 0;
            pointer-events: none;
        }

        .golf-graphic svg {
            width: 100%;
            height: 100%;
        }

        /* Options */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
            flex-grow: 1;
            justify-content: center;
            position: relative;
        }

        .option-button {
            background-color: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 12px 20px;
            font-size: 0.95rem;
            font-weight: 500;
            color: #4a5568;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            user-select: none;
        }

        .option-button:hover {
            border-color: #4fd1c5;
            background-color: #f0fdfa;
        }

        .option-button.selected {
            background-color: #4fd1c5;
            border-color: #4fd1c5;
            color: white;
        }

        .option-button:active {
            transform: scale(0.98);
        }

        input[type="radio"],
        input[type="checkbox"] {
            display: none;
        }

        /* Sliders */
        .slider-container {
            margin: 20px 0;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .slider-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #4fd1c5;
            text-align: center;
            margin-bottom: 15px;
        }

        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            outline: none;
            margin: 15px 0;
            touch-action: manipulation;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #4fd1c5;
            border-radius: 50%;
            cursor: pointer;
            border: 4px solid white;
            box-shadow: 0 2px 8px rgba(79, 209, 197, 0.5);
            min-width: 24px;
            min-height: 24px;
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #4fd1c5;
            border-radius: 50%;
            cursor: pointer;
            border: 4px solid white;
            box-shadow: 0 2px 8px rgba(79, 209, 197, 0.5);
            min-width: 24px;
            min-height: 24px;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #718096;
            margin-top: 8px;
        }

        /* Text input */
        input[type="text"] {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            color: #2d3748;
            background-color: #ffffff;
            transition: all 0.2s ease;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            min-height: 44px;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #4fd1c5;
            background-color: #f0fdfa;
        }

        input[type="text"]::placeholder {
            color: #a0aec0;
        }

        /* Navigation buttons */
        .nav-container {
            display: flex;
            justify-content: space-between;
            margin-top: auto;
            padding-top: 15px;
            gap: 10px;
            flex-shrink: 0;
        }

        .nav-button {
            flex: 1;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            user-select: none;
        }

        .nav-button.primary {
            background-color: #60a5fa;
            color: white;
        }

        .nav-button.primary:hover {
            background-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(96, 165, 250, 0.4);
        }

        .nav-button.primary:active {
            transform: translateY(0);
        }

        .nav-button.secondary {
            background-color: #e2e8f0;
            color: #4a5568;
        }

        .nav-button.secondary:hover {
            background-color: #cbd5e0;
        }

        .nav-button.secondary:active {
            transform: scale(0.98);
        }

        .nav-button:disabled {
            background-color: #e2e8f0;
            color: #a0aec0;
            cursor: not-allowed;
            transform: none;
        }

        /* Shot diagram */
        .shot-diagram-container {
            position: relative;
            width: 100%;
            max-width: 350px;
            height: 200px;
            margin: 30px auto;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            overflow: hidden;
            background-color: #f7fafc;
        }

        .shot-diagram-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            border-radius: 16px;
            cursor: pointer;
            transition: opacity 0.3s ease;
            z-index: 10;
        }

        .shot-diagram-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* Hand diagram */
        .hand-diagram {
            width: 150px;
            height: 150px;
            margin: 15px auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hand-diagram svg {
            width: 100%;
            height: 100%;
        }

        /* Survey pages */
        .survey-page {
            display: none;
            flex-direction: column;
            flex-grow: 1;
            animation: fadeIn 0.4s ease-out;
            height: 100%;
            overflow: hidden;
        }

        .survey-page.active {
            display: flex;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Success message */
        .success-message {
            background-color: #e6fffa;
            color: #2c7a7b;
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            display: none;
            margin-top: 20px;
        }

        /* Slot Machine Styles */
        .slot-machine-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 250px;
            margin: 40px 0 30px 0;
            flex-grow: 1;
            width: 100%;
        }

        .slot-machine {
            position: relative;
            width: 300px;
            height: 250px;
            overflow: hidden;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: pan-y;
        }

        .slot-window {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .slot-options {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            position: relative;
        }

        .slot-option {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.8rem;
            font-weight: 600;
            color: #4a5568;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(100%);
            opacity: 0.3;
            cursor: pointer;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .slot-option.active {
            transform: translateY(0);
            opacity: 1;
            color: #2d3748;
            font-weight: 700;
            font-size: 3.2rem;
        }

        .slot-option:not(.active) {
            transform: translateY(100%);
            opacity: 0.3;
        }

        /* Remove highlight bar */
        .slot-highlight {
            display: none;
        }

        /* Add subtle scroll indicators */
        .slot-machine::before,
        .slot-machine::after {
            content: '';
            position: absolute;
            left: 50%;
            width: 0;
            height: 0;
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            z-index: 2;
            pointer-events: none;
            opacity: 0.3;
        }

        .slot-machine::before {
            top: 25px;
            border-bottom: 16px solid #cbd5e0;
        }

        .slot-machine::after {
            bottom: 25px;
            border-top: 16px solid #cbd5e0;
        }

        .slot-machine:hover::before {
            border-bottom-color: #4fd1c5;
            opacity: 0.6;
        }

        .slot-machine:hover::after {
            border-top-color: #4fd1c5;
            opacity: 0.6;
        }

        /* Responsive */
        @media (max-width: 640px) {
            .survey-container {
                padding: 0;
                padding-top: env(safe-area-inset-top);
                align-items: flex-start;
            }
            
            .survey-card {
                padding: 15px;
                height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 20px);
                height: calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 20px);
                border-radius: 20px;
                margin: 10px;
            }

            .question-text {
                font-size: 1.1rem;
                margin-bottom: 20px;
            }

            .question-number {
                font-size: 2rem;
                margin-bottom: 10px;
            }

            .slider-value {
                font-size: 2rem;
            }

            .welcome-content h1 {
                font-size: 1.75rem;
            }

            .welcome-content p {
                font-size: 1rem;
            }

            .begin-button {
                padding: 12px 40px;
                font-size: 0.95rem;
            }

            .options-container {
                gap: 6px;
            }

            .option-button {
                padding: 10px 16px;
                font-size: 0.9rem;
            }

            .nav-button {
                padding: 10px 16px;
                font-size: 0.9rem;
            }

            /* Slot machine mobile styles */
            .slot-machine-container {
                height: 250px;
                margin: 20px 0;
            }

            .slot-machine {
                width: 300px;
                max-width: 98vw;
                height: 250px;
            }

            .slot-option {
                font-size: 2rem;
            }

            .slot-option.active {
                font-size: 2.3rem;
            }

            .slot-highlight {
                height: 35px;
            }
        }

        @media (max-height: 600px) {
            .survey-card {
                max-height: calc(95vh - env(safe-area-inset-top) - env(safe-area-inset-bottom));
                max-height: calc(95dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom));
            }
            
            .question-number {
                font-size: 2rem;
                margin-bottom: 10px;
            }
            
            .question-text {
                font-size: 1.1rem;
                margin-bottom: 15px;
            }
            
            .slider-value {
                font-size: 2rem;
                margin-bottom: 10px;
            }
            
            .welcome-content h1 {
                font-size: 1.75rem;
                margin-bottom: 15px;
            }
            
            .welcome-content p {
                font-size: 1rem;
                margin-bottom: 20px;
            }
            
            .begin-button {
                padding: 12px 40px;
            }
        }

        /* iPhone specific fixes */
        @supports (-webkit-touch-callout: none) {
            .survey-container {
                height: 100vh;
                height: 100dvh;
                padding-top: env(safe-area-inset-top);
                align-items: flex-start;
            }
            
            .survey-card {
                height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 20px);
                height: calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 20px);
                margin: 10px;
            }
            
            input[type="range"] {
                -webkit-appearance: none;
            }
            
            .option-button,
            .nav-button,
            .begin-button {
                -webkit-tap-highlight-color: transparent;
            }
        }

        /* Prevent zoom on input focus */
        @media screen and (-webkit-min-device-pixel-ratio: 0) {
            input[type="text"] {
                font-size: 16px;
            }
        }

        /* Autocomplete styles */
        .autocomplete-list {
            position: absolute;
            top: 100%; /* Position below the input */
            left: 0;
            width: 100%;
            max-height: 200px; /* Limit height for scrolling */
            overflow-y: auto;
            background-color: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000; /* Ensure it's above other elements */
            font-size: 0.95rem;
            color: #4a5568;
            max-width: 300px; /* Match input width */
        }

        .autocomplete-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border-bottom: 1px solid #f0fdfa; /* Subtle separator */
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item:hover {
            background-color: #f0fdfa;
        }

        .autocomplete-item.active {
            background-color: #4fd1c5;
            color: white;
        }
    </style>
</head>
<body>
    <div class="survey-container">
        <div class="survey-card">
            <div class="survey-header">
                <div class="logo">
                    <span>GR</span><span>I</span><span>P</span><span>script</span>
                </div>
                <i class="fas fa-bars menu-icon"></i>
            </div>

            <div class="progress-dots" id="progress-dots">
                <!-- Dots will be generated dynamically -->
    </div>

            <div id="survey-pages">
                <!-- Welcome Page -->
                <div class="survey-page active welcome-page" data-page="0">
                    <div class="golf-graphic">
                        <svg viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
                            <g opacity="0.8">
                                <!-- Golf ball path -->
                                <path d="M 50 350 Q 200 100 350 200" stroke="#4fd1c5" stroke-width="40" fill="none" stroke-linecap="round" opacity="0.4"/>
                                <circle cx="350" cy="200" r="30" fill="#4fd1c5" opacity="0.6"/>
                                
                                <!-- Additional decorative elements -->
                                <circle cx="150" cy="250" r="60" fill="#4fd1c5" opacity="0.2"/>
                                <circle cx="280" cy="320" r="80" fill="#4fd1c5" opacity="0.15"/>
                            </g>
                        </svg>
      </div>
                    <div class="welcome-content" style="position: relative; z-index: 1;">
                        <h1>Welcome to the SmartFIT™ Experience</h1>
                        <p>The most comprehensive and advanced grip fitting technology available to golfers.</p>
                        <button class="begin-button" id="begin-button">BEGIN</button>
                    </div>
    </div>

                <!-- Section 1 Intro -->
                <div class="survey-page" data-page="1">
                    <div class="section-intro">
                        <h2>Player Profile</h2>
                        <p>In this section, we'll learn about your player profile. This helps us understand your general golfing background.</p>
      </div>
                    <div class="nav-container">
                        <button class="nav-button primary" id="section1-continue">Continue</button>
    </div>
    </div>

                <!-- Question 1: Age -->
                <div class="survey-page" data-page="2">
                    <div class="question-number">1</div>
                    <h2 class="question-text">What's your age?</h2>
                    <div class="slot-machine-container">
                        <div class="slot-machine">
                            <div class="slot-window">
                                <div class="slot-options" id="age-options">
                                    <div class="slot-option" data-value="Under 18">Under 18</div>
                                    <div class="slot-option" data-value="18-24">18-24</div>
                                    <div class="slot-option" data-value="25-34">25-34</div>
                                    <div class="slot-option" data-value="35-44">35-44</div>
                                    <div class="slot-option" data-value="45-54">45-54</div>
                                    <div class="slot-option" data-value="55-64">55-64</div>
                                    <div class="slot-option" data-value="65+">65+</div>
                                </div>
                            </div>
                            <div class="slot-highlight"></div>
                        </div>
                    </div>
    </div>

                <!-- Question 2: Gender -->
                <div class="survey-page" data-page="3">
                    <div class="question-number">2</div>
                    <h2 class="question-text">What's your gender?</h2>
                    <div class="options-container">
                        <input type="radio" id="gender-male" name="gender" value="Male">
                        <label for="gender-male" class="option-button">Male</label>
                        
                        <input type="radio" id="gender-female" name="gender" value="Female">
                        <label for="gender-female" class="option-button">Female</label>
                        
                        <input type="radio" id="gender-prefer-not" name="gender" value="Prefer not to say">
                        <label for="gender-prefer-not" class="option-button">Prefer not to say</label>
      </div>
    </div>

                <!-- Question 3: Handicap -->
                <div class="survey-page" data-page="4">
                    <div class="question-number">3</div>
                    <h2 class="question-text">What is your handicap?</h2>
                    <div class="slider-container">
                        <div class="slider-value" id="handicap-value">10-14</div>
                        <input type="range" id="handicap-slider" name="handicap" min="0" max="4" value="2" step="1">
                        <div class="slider-labels">
                            <span>Scratch to 4</span>
                            <span>21+</span>
                        </div>
                    </div>
                </div>

                <!-- Question 4: Rounds per year -->
                <div class="survey-page" data-page="5">
                    <div class="question-number">4</div>
                    <h2 class="question-text">How many rounds a year do you play?</h2>
                    <div class="slider-container">
                        <div class="slider-value" id="rounds-value">40</div>
                        <input type="range" id="rounds-slider" name="rounds-per-year" min="5" max="80" value="40" step="5">
                        <div class="slider-labels">
                            <span>5</span>
                            <span>80</span>
                        </div>
                    </div>
                </div>

                <!-- Section 2 Intro -->
                <div class="survey-page" data-page="8">
                    <div class="section-intro">
                        <h2>Physical Considerations & Grip Preferences</h2>
                        <p>Now, tell us about any physical considerations and grip preferences. This help us understand any physical factors that may affect your grip recommendation.</p>
                    </div>
                    <div class="nav-container">
                        <button class="nav-button primary" id="section2-continue">Continue</button>
                    </div>
                </div>

                <!-- Question 7: Physical conditions -->
                <div class="survey-page" data-page="9">
                    <div class="question-number">7</div>
                    <h2 class="question-text">Do you experience any of the following? (Check all that apply)</h2>
                    <div class="options-container">
                        <input type="checkbox" id="condition-arthritis" name="physical-condition" value="Arthritis">
                        <label for="condition-arthritis" class="option-button">Arthritis</label>
                        
                        <input type="checkbox" id="condition-limited" name="physical-condition" value="Limited Hand Strength">
                        <label for="condition-limited" class="option-button">Limited Hand Strength</label>
                        
                        <input type="checkbox" id="condition-tendinitis" name="physical-condition" value="Tendinitis">
                        <label for="condition-tendinitis" class="option-button">Tendinitis</label>
                        
                        <input type="checkbox" id="condition-none" name="physical-condition" value="None of the above">
                        <label for="condition-none" class="option-button">None of the above</label>
                    </div>
                </div>

                <!-- Question 8: Moisture control -->
                <div class="survey-page" data-page="10">
                    <div class="question-number">8</div>
                    <h2 class="question-text">Do your grips need to help with moisture control?</h2>
                    <div class="options-container">
                        <input type="radio" id="moisture-yes" name="moisture-control" value="Yes, I struggle with slippage">
                        <label for="moisture-yes" class="option-button">Yes, I struggle with slippage</label>
                        
                        <input type="radio" id="moisture-no" name="moisture-control" value="No, moisture isn't an issue">
                        <label for="moisture-no" class="option-button">No, moisture isn't an issue</label>
                    </div>
                </div>

                <!-- Question 9: Grip feel -->
                <div class="survey-page" data-page="11">
                    <div class="question-number">9</div>
                    <h2 class="question-text">How would you describe your current grip's feel?</h2>
                    <div class="options-container">
                        <input type="radio" id="feel-too-soft" name="grip-feel" value="Too soft">
                        <label for="feel-too-soft" class="option-button">Too soft</label>
                        
                        <input type="radio" id="feel-slightly-soft" name="grip-feel" value="Slightly soft">
                        <label for="feel-slightly-soft" class="option-button">Slightly soft</label>
                        
                        <input type="radio" id="feel-just-right" name="grip-feel" value="Just right">
                        <label for="feel-just-right" class="option-button">Just right</label>
                        
                        <input type="radio" id="feel-slightly-firm" name="grip-feel" value="Slightly firm">
                        <label for="feel-slightly-firm" class="option-button">Slightly firm</label>
                        
                        <input type="radio" id="feel-too-firm" name="grip-feel" value="Too Firm">
                        <label for="feel-too-firm" class="option-button">Too Firm</label>
                    </div>
                </div>

                <!-- Question 6: Current grip model -->
                <div class="survey-page" data-page="7">
                    <div class="question-number">6</div>
                    <h2 class="question-text">What model(s) are your current grips? (If you know)</h2>
                    <div class="options-container" style="margin-bottom:0;">
                        <input type="text" id="current-grip-input" name="current-grip" placeholder="Start typing grip name..." autocomplete="off" style="font-size:1.1rem; padding:16px 20px; border:2px solid #e2e8f0; border-radius:12px; width:100%; background:#fff;">
                        <div id="grip-autocomplete" class="autocomplete-list" style="position:relative;z-index:10;"></div>
                        <div style="margin-top:16px;">
                            <input type="radio" id="grip-dont-know" name="current-grip-radio" value="I Don't know">
                            <label for="grip-dont-know" class="option-button">I Don't know</label>
                        </div>
                    </div>
                </div>


                <!-- Question 10: Swing hand -->
                <div class="survey-page" data-page="12">
                    <div class="question-number">10</div>
                    <h2 class="question-text">Which hand do you swing with?</h2>
                    <div class="options-container" style="flex-direction: row; max-width: 300px; margin: 0 auto;">
                        <input type="radio" id="swing-left" name="swing-hand" value="Left">
                        <label for="swing-left" class="option-button" style="flex: 1;">Left</label>
                        
                        <input type="radio" id="swing-right" name="swing-hand" value="Right">
                        <label for="swing-right" class="option-button" style="flex: 1;">Right</label>
                    </div>
                </div>

                <!-- Question 11: Iron shot shape -->
                <div class="survey-page" data-page="13">
                    <div class="question-number">11</div>
                    <h2 class="question-text">What's your typical iron shot shape?</h2>
                    <div class="hand-diagram">
                        <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                            <!-- Simplified hand and club illustration -->
                            <g id="hand-illustration">
                                <!-- Club shaft -->
                                <line x1="100" y1="20" x2="100" y2="180" stroke="#718096" stroke-width="4" stroke-linecap="round"/>
                                
                                <!-- Hands -->
                                <ellipse cx="100" cy="100" rx="25" ry="35" fill="#fbbf24" opacity="0.8"/>
                                <ellipse cx="100" cy="120" rx="25" ry="35" fill="#f59e0b" opacity="0.8"/>
                                
                                <!-- Ball path indicator -->
                                <path id="shot-path" d="M 100 180 Q 100 150 100 120" stroke="#4fd1c5" stroke-width="3" fill="none" stroke-dasharray="5,5"/>
                            </g>
                        </svg>
                    </div>
                    <div class="slider-container">
                        <input type="range" id="iron-shot-slider" name="iron-shot-shape" min="0" max="7" value="4" step="1">
                        <div class="slider-labels">
                            <span>Pull Hook</span>
                            <span>Push Slice</span>
                        </div>
                    </div>
                </div>

                <!-- Question 12: Driver shot shape -->
                <div class="survey-page" data-page="14">
                    <div class="question-number">12</div>
                    <h2 class="question-text">What's your typical driver shot shape?</h2>
                    <div class="hand-diagram">
                        <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                            <!-- Simplified hand and club illustration -->
                            <g id="hand-illustration">
                                <!-- Club shaft -->
                                <line x1="100" y1="20" x2="100" y2="180" stroke="#718096" stroke-width="4" stroke-linecap="round"/>
                                
                                <!-- Hands -->
                                <ellipse cx="100" cy="100" rx="25" ry="35" fill="#fbbf24" opacity="0.8"/>
                                <ellipse cx="100" cy="120" rx="25" ry="35" fill="#f59e0b" opacity="0.8"/>
                                
                                <!-- Ball path indicator -->
                                <path id="shot-path" d="M 100 180 Q 100 150 100 120" stroke="#4fd1c5" stroke-width="3" fill="none" stroke-dasharray="5,5"/>
                            </g>
                        </svg>
                    </div>
                    <div class="slider-container">
                        <input type="range" id="driver-shot-slider" name="driver-shot-shape" min="0" max="7" value="4" step="1">
                        <div class="slider-labels">
                            <span>Pull Hook</span>
                            <span>Push Slice</span>
                        </div>
                    </div>
                </div>

                <!-- Section 3 Intro -->
                <div class="survey-page" data-page="15">
                    <div class="section-intro">
                        <h2>Goals</h2>
                        <p>Lastly, tell us about your goals. Tell us what you want to improve with your new grips.</p>
                    </div>
                    <div class="nav-container">
                        <button class="nav-button primary" id="section3-continue">Continue</button>
                    </div>
                </div>

                <!-- Question 13: Change iron shot shape -->
                <div class="survey-page" data-page="16">
                    <div class="question-number">13</div>
                    <h2 class="question-text">Do you want to change your iron shot shape?</h2>
                    <div class="options-container">
                        <input type="radio" id="iron-change-straighter" name="iron-shot-change" value="Yes, I want straighter shots">
                        <label for="iron-change-straighter" class="option-button">Yes, I want straighter shots</label>
                        
                        <input type="radio" id="iron-change-draw" name="iron-shot-change" value="Yes, I want to draw it more">
                        <label for="iron-change-draw" class="option-button">Yes, I want to draw it more</label>
                        
                        <input type="radio" id="iron-change-fade" name="iron-shot-change" value="Yes, I want to fade it more">
                        <label for="iron-change-fade" class="option-button">Yes, I want to fade it more</label>
                        
                        <input type="radio" id="iron-change-no" name="iron-shot-change" value="No, I like my current shape">
                        <label for="iron-change-no" class="option-button">No, I like my current shape</label>
                    </div>
                </div>

                <!-- Question 14: Change driver shot shape -->
                <div class="survey-page" data-page="17">
                    <div class="question-number">14</div>
                    <h2 class="question-text">Do you want to change your driver shot shape?</h2>
                    <div class="options-container">
                        <input type="radio" id="driver-change-straighter" name="driver-shot-change" value="Yes, I want straighter shots">
                        <label for="driver-change-straighter" class="option-button">Yes, I want straighter shots</label>
                        
                        <input type="radio" id="driver-change-draw" name="driver-shot-change" value="Yes, I want to draw it more">
                        <label for="driver-change-draw" class="option-button">Yes, I want to draw it more</label>
                        
                        <input type="radio" id="driver-change-fade" name="driver-shot-change" value="Yes, I want to fade it more">
                        <label for="driver-change-fade" class="option-button">Yes, I want to fade it more</label>
                        
                        <input type="radio" id="driver-change-no" name="driver-shot-change" value="No, I like my current shape">
                        <label for="driver-change-no" class="option-button">No, I like my current shape</label>
                    </div>
                </div>

                <!-- Question 15: Grip improvements -->
                <div class="survey-page" data-page="18">
                    <div class="question-number">15</div>
                    <h2 class="question-text">What do you want to improve with your new grips? (check all that apply)</h2>
                    <div class="options-container">
                        <input type="checkbox" id="improve-fit" name="grip-improvements" value="Better fit">
                        <label for="improve-fit" class="option-button">Better fit</label>
                        
                        <input type="checkbox" id="improve-control" name="grip-improvements" value="Better club control">
                        <label for="improve-control" class="option-button">Better club control</label>
                        
                        <input type="checkbox" id="improve-feel" name="grip-improvements" value="Improved feel and feedback">
                        <label for="improve-feel" class="option-button">Improved feel and feedback</label>
                        
                        <input type="checkbox" id="improve-moisture" name="grip-improvements" value="Better grip in wet conditions">
                        <label for="improve-moisture" class="option-button">Better grip in wet conditions</label>
                        
                        <input type="checkbox" id="improve-comfort" name="grip-improvements" value="More comfort">
                        <label for="improve-comfort" class="option-button">More comfort</label>
                        
                        <input type="checkbox" id="improve-fatigue" name="grip-improvements" value="Less hand fatigue">
                        <label for="improve-fatigue" class="option-button">Less hand fatigue</label>
                    </div>
                </div>

                <!-- Section 4 Intro: Hand Measurements -->
                <div class="survey-page" data-page="19">
                    <div class="section-intro">
                        <h2>Hand Measurements</h2>
                        <p>It's time to capture your unique hand measurements</p>
                        <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">A U.S. coin is required as a reference object for precise hand measurement.</p>
                    </div>
                    <div class="nav-container">
                        <button class="nav-button primary" id="section4-continue">Continue</button>
                    </div>
                </div>

                <!-- Hand Measurement Instructions Screen -->
                <div class="survey-page" data-page="20">
                    <div class="section-intro">
                        <h2>Instructions</h2>
                        <p style="margin-bottom: 18px;">You'll need any U.S. coin (Quarter, Nickel, etc.) to complete this section. It's used as a reference object for precise measurements.</p>
                        <ol style="text-align: left; max-width: 400px; margin: 0 auto; font-size: 1.05rem; color: #2d3748;">
                            <li style="margin-bottom: 10px;">Place your <span id="selected-hand-label">Left</span> hand flat, fingers slightly apart</li>
                            <li style="margin-bottom: 10px;">Put the coin in the center of your palm</li>
                            <li style="margin-bottom: 10px;">Hold phone 12-18 inches above your hand</li>
                            <li style="margin-bottom: 10px;">Take photo – make sure hand and coin are fully visible and well-lit</li>
                        </ol>
                    </div>
                    <div class="nav-container">
                        <button class="nav-button primary" id="hand-instructions-continue">Continue</button>
                        <button class="nav-button secondary" id="hand-instructions-example">See example</button>
                    </div>
                </div>

                <!-- Hand Photo Upload Screen -->
                <div class="survey-page" data-page="21">
                    <div class="question-number">16</div>
                    <h2 class="question-text">Take a photo of your hand</h2>
                    
                    <div id="camera-container" style="text-align: center; margin: 20px 0;">
                        <div id="camera-placeholder" style="width: 300px; height: 400px; margin: 0 auto; border: 2px dashed #cbd5e0; border-radius: 12px; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #f7fafc;">
                            <i class="fas fa-camera" style="font-size: 3rem; color: #cbd5e0; margin-bottom: 15px;"></i>
                            <p style="color: #718096; font-size: 1rem;">Tap to open camera</p>
                        </div>
                        <input type="file" id="camera-input" accept="image/*" capture="environment" style="display: none;">
                        <button id="open-camera-btn" class="nav-button primary" style="margin-top: 15px;">Open Camera</button>
                    </div>
                    
                    <div id="photo-preview" style="display: none; text-align: center; margin: 20px 0;">
                        <img id="captured-image" style="max-width: 300px; max-height: 400px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" />
                    </div>
                    
                    <div id="photo-actions" style="display: none; margin-top: 20px;">
                        <div class="nav-container">
                            <button class="nav-button secondary" id="retake-photo-btn">Retake</button>
                            <button class="nav-button primary" id="confirm-photo-btn">Confirm</button>
                        </div>
                    </div>
                </div>
    </div>

            <div class="nav-container" id="nav-container">
                <button class="nav-button secondary" id="back-button">Back</button>
                <button class="nav-button primary" id="continue-button">Continue</button>
            </div>
    </div>
  </div>

  <script>
        // Survey state
        let currentPage = 0;
        const totalPages = 22; // Including welcome and photo upload
        const surveyData = {};
        let selectedAge = null;

        // DOM elements
        const pages = document.querySelectorAll('.survey-page');
        const backButton = document.getElementById('back-button');
        const continueButton = document.getElementById('continue-button');
        const navContainer = document.getElementById('nav-container');
        const progressDots = document.getElementById('progress-dots');

        // Slot machine functionality
        function initSlotMachine() {
            const slotOptions = document.querySelectorAll('.slot-option');
            const slotMachine = document.querySelector('.slot-machine');
            let currentIndex = 0;
            let isDragging = false;
            let startY = 0;
            let currentY = 0;

            // Set initial active option
            if (slotOptions.length > 0) {
                slotOptions[0].classList.add('active');
                selectedAge = slotOptions[0].getAttribute('data-value');
                slotMachine.classList.add('active');
            }

            // Touch events for mobile
            slotMachine.addEventListener('touchstart', handleTouchStart, { passive: false });
            slotMachine.addEventListener('touchmove', handleTouchMove, { passive: false });
            slotMachine.addEventListener('touchend', handleTouchEnd, { passive: false });

            // Mouse events for desktop
            slotMachine.addEventListener('mousedown', handleMouseStart);
            slotMachine.addEventListener('mousemove', handleMouseMove);
            slotMachine.addEventListener('mouseup', handleMouseEnd);
            slotMachine.addEventListener('mouseleave', handleMouseEnd);

            function handleTouchStart(e) {
                e.preventDefault();
                isDragging = true;
                startY = e.touches[0].clientY;
                currentY = startY;
            }

            function handleTouchMove(e) {
                e.preventDefault();
                if (!isDragging) return;
                
                currentY = e.touches[0].clientY;
                const deltaY = currentY - startY;
                const sensitivity = 0.5;
                
                if (Math.abs(deltaY) > 30) {
                    if (deltaY > 0 && currentIndex > 0) {
                        // Scroll down
                        currentIndex--;
                        startY = currentY;
                    } else if (deltaY < 0 && currentIndex < slotOptions.length - 1) {
                        // Scroll up
                        currentIndex++;
                        startY = currentY;
                    }
                    updateSlotDisplay();
                }
            }

            function handleTouchEnd(e) {
                e.preventDefault();
                isDragging = false;
                updateContinueButton();
            }

            function handleMouseStart(e) {
                isDragging = true;
                startY = e.clientY;
                currentY = startY;
                e.preventDefault();
            }

            function handleMouseMove(e) {
                if (!isDragging) return;
                
                currentY = e.clientY;
                const deltaY = currentY - startY;
                const sensitivity = 0.5;
                
                if (Math.abs(deltaY) > 30) {
                    if (deltaY > 0 && currentIndex > 0) {
                        // Scroll down
                        currentIndex--;
                        startY = currentY;
                    } else if (deltaY < 0 && currentIndex < slotOptions.length - 1) {
                        // Scroll up
                        currentIndex++;
                        startY = currentY;
                    }
                    updateSlotDisplay();
                }
            }

            function handleMouseEnd(e) {
                isDragging = false;
                updateContinueButton();
            }

            function updateSlotDisplay() {
                slotOptions.forEach((option, index) => {
                    option.classList.remove('active');
                    if (index === currentIndex) {
                        option.classList.add('active');
                        selectedAge = option.getAttribute('data-value');
                    }
                });
                slotMachine.classList.add('active');
            }

            // Add click functionality for direct selection
            slotOptions.forEach((option, index) => {
                option.addEventListener('click', () => {
                    currentIndex = index;
                    updateSlotDisplay();
                    updateContinueButton();
                });
            });
        }

        // Initialize progress dots
        function initProgressDots() {
            progressDots.innerHTML = '';
            for (let i = 0; i < totalPages - 2; i++) { // Exclude welcome and completion
                const dot = document.createElement('div');
                dot.className = 'progress-dot';
                progressDots.appendChild(dot);
            }
        }

        // Update progress dots
        function updateProgressDots() {
            const dots = progressDots.querySelectorAll('.progress-dot');
            dots.forEach((dot, index) => {
                if (index === currentPage - 1) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });
        }

        // Show page
        function showPage(pageIndex) {
            pages.forEach((page, index) => {
                if (index === pageIndex) {
                    page.classList.add('active');
                } else {
                    page.classList.remove('active');
                }
            });

            // Initialize slot machine if on age question
            if (pageIndex === 2) {
                setTimeout(() => {
                    initSlotMachine();
                }, 100);
            }

            // Initialize grip autocomplete if on grip input page
            if (pageIndex === 7) {
                setTimeout(() => {
                    setupGripAutocomplete();
                }, 100);
            }

            // Set visual state for pre-selected radio buttons
            const currentPageEl = pages[pageIndex];
            if (currentPageEl) {
                const checkedInputs = currentPageEl.querySelectorAll('input[type="radio"]:checked, input[type="checkbox"]:checked');
                checkedInputs.forEach(input => {
                    const label = document.querySelector(`label[for="${input.id}"]`);
                    if (label && label.classList.contains('option-button')) {
                        label.classList.add('selected');
                    }
                });
            }

            // Update navigation visibility
            if (pageIndex === 0) {
                // Welcome page
                navContainer.style.display = 'none';
                progressDots.style.display = 'none';
            } else if (pageIndex === totalPages - 1) {
                // Completion page
                navContainer.style.display = 'none';
                progressDots.style.display = 'none';
            } else if (pageIndex === 1 || pageIndex === 6) {
                // Section intro pages
                navContainer.style.display = 'none';
                progressDots.style.display = 'flex';
            } else {
                // Regular question pages
                navContainer.style.display = 'flex';
                progressDots.style.display = 'flex';
                backButton.style.display = pageIndex > 1 ? 'block' : 'none';
            }

            updateProgressDots();
            updateContinueButton();

            // Auto-select hand on hand instructions page
            if (pageIndex === 20) {
                setTimeout(autoSelectHandFromSwing, 100);
            }
        }

        // Check if current page is valid
        function isPageValid() {
            const currentPageEl = pages[currentPage];
            
            // Special handling for age question (slot machine)
            if (currentPage === 2) {
                return selectedAge !== null;
            }
            
            const inputs = currentPageEl.querySelectorAll('input[type="radio"], input[type="checkbox"], input[type="text"]');
            
            if (inputs.length > 0) {
                if (inputs.length === 1 && inputs[0].type === 'text') {
                    // For the new grip input, it's always valid if it's not empty
                    return inputs[0].value.trim() !== '';
                }
                return Array.from(inputs).some(input => input.checked);
            }
            
            return true; // Pages without inputs are always valid
        }

        // Update continue button state
        function updateContinueButton() {
            if (currentPage === totalPages - 2) {
                continueButton.textContent = 'Submit';
            } else {
                continueButton.textContent = 'Continue';
            }
            
            continueButton.disabled = !isPageValid();
        }

        // Handle option selection
        function handleOptionSelection(e) {
            if (e.target.classList.contains('option-button')) {
                // Use the 'for' attribute to find the associated input
                const inputId = e.target.getAttribute('for');
                let input = null;
                if (inputId) {
                    input = document.getElementById(inputId);
                } else {
                    input = e.target.previousElementSibling;
                }
                if (input && (input.type === 'radio' || input.type === 'checkbox')) {
                    input.checked = !input.checked;
                    
                    // Update visual state
                    if (input.type === 'radio') {
                        const allOptions = input.closest('.options-container').querySelectorAll('.option-button');
                        allOptions.forEach(opt => opt.classList.remove('selected'));
                        if (input.checked) {
                            e.target.classList.add('selected');
                        }
                    } else {
                        e.target.classList.toggle('selected', input.checked);
                    }
                    
                    // Handle "None of the above" logic
                    if (input.name === 'physical-condition') {
                        if (input.id === 'condition-none' && input.checked) {
                            const otherCheckboxes = document.querySelectorAll('input[name="physical-condition"]:not(#condition-none)');
                            otherCheckboxes.forEach(cb => {
                                cb.checked = false;
                                cb.nextElementSibling.classList.remove('selected');
                            });
                        } else if (input.id !== 'condition-none' && input.checked) {
                            document.getElementById('condition-none').checked = false;
                            document.getElementById('condition-none').nextElementSibling.classList.remove('selected');
                        }
                    }
                    updateContinueButton();
                }
            }
        }

        // Handle slider updates
        function handleSliderUpdate(e) {
            if (e.target.id === 'handicap-slider') {
                const handicapRanges = ['Scratch to 4', '5-9', '10-14', '15-20', '21+'];
                const value = parseInt(e.target.value);
                document.getElementById('handicap-value').textContent = handicapRanges[value];
            }
            if (e.target.id === 'rounds-slider') {
                const val = parseInt(e.target.value, 10);
                document.getElementById('rounds-value').textContent = val;
            }
            if (e.target.id === 'iron-shot-slider') {
                const shotShapes = ['Pull Hook', 'Hook', 'Pull', 'Draw', 'Straight', 'Push', 'Slice', 'Push Slice'];
                const value = parseInt(e.target.value);
                // Update shot diagram or display value as needed
            }
            if (e.target.id === 'driver-shot-slider') {
                const shotShapes = ['Pull Hook', 'Hook', 'Pull', 'Draw', 'Straight', 'Push', 'Slice', 'Push Slice'];
                const value = parseInt(e.target.value);
                // Update shot diagram or display value as needed
            }
        }

        // Navigation
        function goToNextPage() {
            if (currentPage < totalPages - 1) {
                currentPage++;
                showPage(currentPage);
            }
        }

        function goToPrevPage() {
            if (currentPage > 1) {
                currentPage--;
                showPage(currentPage);
            }
        }

        // Event listeners
        document.getElementById('begin-button').addEventListener('click', () => {
            currentPage = 1;
            showPage(currentPage);
        });
        document.getElementById('section1-continue').addEventListener('click', () => {
            currentPage = 2;
            showPage(currentPage);
        });
        document.getElementById('section2-continue').addEventListener('click', () => {
            currentPage = 9;
            showPage(currentPage);
        });
        document.getElementById('section3-continue').addEventListener('click', () => {
            currentPage = 16;
            showPage(currentPage);
        });
        document.getElementById('section4-continue').addEventListener('click', () => {
            currentPage = 20;
            showPage(currentPage);
        });
        backButton.addEventListener('click', goToPrevPage);
        continueButton.addEventListener('click', goToNextPage);
        document.getElementById('survey-pages').addEventListener('click', handleOptionSelection);
        document.getElementById('survey-pages').addEventListener('input', handleSliderUpdate);

        // --- Grip List for Autocomplete ---
        const gripModelsRaw = [
            { brand: "Golf Pride", models: [
                "Tour Velvet","Tour Velvet 360","Tour Velvet Plus4","Tour Velvet Align","Tour Velvet Cord","Tour Velvet BCPP (Brushed Cotton Cord Plus4)","MCC (Multi Compound Cord)","MCC Plus4","MCC Align","MCC Plus4 Align","MCC Align MAX","MCC Plus4 Align MAX","MCC Teams","CP2 Pro","CP2 Wrap","CPX","Z-Grip","Z-Grip Cord","Z-Grip Align","ZGRIP Plus2","Tour Wrap 2G","VDR (Variable Density Rubber)","ZGRIP Patriot","Decade MultiCompound","Decade MultiCompound Plus4","New Decade MultiCompound","New Decade MultiCompound Plus4","Niion","Pro Only Red Star","Pro Only Blue Star","Pro Only Green Star","V-55 Cord","Tour Velvet BCT Cord","Tour Velvet Full Cord","Tour Velvet Rubber","Dual Durometer","Whiteout","BlackOut","Pro Soft","Victory","Performer","Speedline","GX","G2C"
            ]},
            { brand: "Lamkin", models: [
                "Crossline","Crossline Plus","Crossline 360","Crossline Cord","Crossline ACE","Crossline Full-Cord","Crossline Tour Black","Crossline Tour Black Full-Cord","Crossline 2.0","UTx","UTx Cord","Sonar","Sonar Plus","Sonar Tour","Sonar Tour Calibrate","Sonar+ Tour Calibrate","Sonar+ Hero","ST Hybrid","ST Hybrid Plus","ST+2 Hybrid","ST+2 Hybrid Calibrate","Comfort Plus","Deep Etched","Deep Etched Cord","Calibrate","Z5","Z5 Standard","Z5 Midsize","Z5 Oversize","R.E.L. ACE","R.E.L. 3GEN","Tour Black","Wrap-Tech","Perma Wrap","Perma Wrap ACE","Genesis","Genesis Material","i-Line","Gripsaver","Arthritic","Pro Soft","Comfort Soft","Performance Plus","Velvet","Velvet Plus","X10"
            ]},
            { brand: "SuperStroke", models: [
                "S-Tech","S-Tech Cord","Soft Wrap TC","Cross Comfort","Comfort","Crossline 2.0","Element","Player","REVL","REVL Tour","REVL Pro","REVL Max","Xrossline 2.0","Crossline Full Cord"
            ]},
            { brand: "Winn", models: [
                "Dri-Tac","Dri-Tac 2.0","Dri-Tac Wrap","Dri-Tac LT","Dri-Tac Dark Gray","Dri-Tac Standard","Dri-Tac Midsize","Dri-Tac Oversize","Dri-Tac Jumbo","Excel","Excel Wrap","Excel RF","Pro X","Pro X 1.18","Pro X 1.32","Pro X 1.60","6715W","Winnlite","V17","PCH","X-Pro","Grip 2.0","DuraTech","WinnPro X","WinnPro Wrap","Polymer Rod","Comfort Soft","Comfort Wrap","Winn Grips 21","Winn Wrap","Attack"
            ]},
            { brand: "IOMIC", models: [
                "Sticky 2.3","Sticky 1.8","Sticky Evolution 2.3","Sticky Evolution 1.8","Sticky Opus 3","X-Grip","X-Grip Hard","X-Grip Soft","X-Evolution","LTC (Low Torque Control)","Absolute-X","Black Armor","Black Armor 2","I-Classic","Art Grip Series","Shallow","Medium","Deep","Standard Balance","Midsize Balance","Large Balance","Sticky Shadow","Sticky Jumbo","Sticky Standard","Sticky Midsize","X-Grip 2.3","X-Grip 1.8","PlayGrip","GripMaster"
            ]},
            { brand: "Karma", models: [
                "Velour","Velour Plus","Velour Standard","Velour Midsize","Velour Jumbo","Dual Touch","Dual Touch Standard","Dual Touch Midsize","Black Velvet","Black Velvet Standard","Black Velvet Midsize","Black Velvet Jumbo","Neion","Neion II","Neion Plus","Smooth","Smooth Black","Smooth White","Super Lite","Pro","RF 360","Excel 360","Arthritic","Revolution","Ripple","Splash","Extreme Soft","Natural","Classic Wrap","Pro Wrap","Velvet Cord","Jumbo Wrap","V-Cord","Ladies Velour"
            ]},
            { brand: "JumboMax", models: [
                "UltraLite Small","UltraLite Small+","UltraLite Medium","UltraLite Medium+","UltraLite Large","UltraLite Large+","UltraLite X-Large","Tour Series Small","Tour Series Small+","Tour Series Medium","Tour Series Medium+","Tour Series Large","Tour Series Large+","Tour Series X-Large","Tour Series Standard Oversize","Tour Series Standard Jumbo","Tour Series Extra Small","Wrap Series Small","Wrap Series Medium","Wrap Series Large","Original Wrap XS","Original Wrap Small","Original Wrap Medium","Original Wrap Large","Original Wrap Extra Large","STR8 Tech Non-Tapered","STR8 Tech Small","STR8 Tech Medium","STR8 Tech Large","STR8 Tech X-Large","ZenLite Small","ZenLite Medium","ZenLite Large"
            ]},
            { brand: "Tacki-Mac", models: [
                "Command","Command Plus","Command RF","Command X","Pro Plus Wrap","Pro Plus Neon","Pro Tour Wrap","Tour Select","Tour Pro","Tour Pro Jumbo","Perforated Tour Pro","Perforated Tour Pro Jumbo","Itomic","Itomic IT2","Serrated","Serrated Oversize","Arthritic","Arthritic Serrated","Unified Wrap","Unified Wrap Non-Tapered","Unified Wrap Non-Tapered Oversize","Standard Wrap","Midsize Wrap","Oversize Wrap","Jumbo Wrap","Junior","Ladies","Bubble Shaft","Velvet","Grip Rite","Rib Grip","Tacki Pro"
            ]},
            { brand: "Ping", models: [
                "PP58","PP58 Midsize","PP58 Oversize","PP60","PP60 Midsize","PP62","ID8","ID8 Undersize","ID8 Standard","ID8 Midsize","ID8 Jumbo","Blackout","703","703 Gold","703 Silver","5L","5L Round","5L Cord","Karsten"
            ]},
            { brand: "NO1 Grip", models: [
                "50 Series","50 Series Standard","50 Series Midsize","50 Series Jumbo","48 Series","48 Series Standard","48 Series Midsize","Traveler","Traveler Standard","Traveler Midsize","Plus Series","Plus Series Standard","Plus Series Midsize","ST Series","ST Standard","ST Midsize","Pro Tour","Sticky 2.3","Sticky 1.8","Diamond","Diamond Plus"
            ]},
            { brand: "Avon", models: [
                "Chamois","Chamois II","Chamois Yellow","Chamois Jumbo","Arthritic","Pro D2X","Pro D2X Wrap","Dual Density","Nexus Tour Velvet","Air Cushion","Pro VX","VX Tour Wrap","Multi-Compound","Diamond Grip","Classic Wrap","Pro Soft","Standard Grip"
            ]},
            { brand: "Pure Grips", models: [
                "DTX","DTX Standard","DTX Midsize","DTX Wrap","Pro","Pro Standard","Pro Midsize","Midsize Pro","Midsize DTX","Big Dog","P2 Wrap","P2 Classic","The Grip","Players Wrap","HEX","Tapeless Installation"
            ]},
            { brand: "Boccieri Golf", models: [
                "Secret Grip","Tour Series","Control Series","Weighted Grip"
            ]},
            { brand: "Grip Master", models: [
                "Montana Cow","Stitchback Reminder","Classic Leather","Tour Leather","Kangaroo Leather","Custom Leather","Heritage","Pro Tour","Classic Wrap"
            ]},
            { brand: "Star Grip", models: [
                "Classic","Tour","Sidewinder","S-Wave","Diamond","Tour Soft","Wrap Tech","Players Choice"
            ]},
            { brand: "Loudmouth Golf", models: [
                "Magic Bus","Shagadelic","Captain Thunderbolt","Savage Flamingos","Paint Balls","Fore Play","Champagne Superstar","Razzle Dazzle","Oakmont Houndstooth"
            ]},
            { brand: "Champkey", models: [
                "Victor","X Rubber","Tour Pro","Genesis","MTB","FCS"
            ]}
        ];
        // Flatten to ["Brand Model"]
        const gripList = gripModelsRaw.flatMap(g => g.models.map(m => `${g.brand} ${m}`));

        // --- Autocomplete Logic ---
        function setupGripAutocomplete() {
            const input = document.getElementById('current-grip-input');
            const list = document.getElementById('grip-autocomplete');
            if (!input || !list) return;
            if (input._autocompleteInitialized) return; // Prevent duplicate listeners
            input._autocompleteInitialized = true;
            let currentFocus = -1;

            input.addEventListener('input', function() {
                const val = this.value.trim().toLowerCase();
                list.innerHTML = '';
                console.log('Grip input event fired. Value:', val);
                if (!val) return;
                const matches = gripList.filter(g => g.toLowerCase().includes(val)).slice(0, 8);
                console.log('Autocomplete matches:', matches);
                matches.forEach(grip => {
                    const item = document.createElement('div');
                    item.className = 'autocomplete-item';
                    item.textContent = grip;
                    item.tabIndex = 0;
                    item.onclick = function() {
                        input.value = grip;
                        list.innerHTML = '';
                        updateContinueButton();
                    };
                    item.onkeydown = function(e) {
                        if (e.key === 'Enter') {
                            input.value = grip;
                            list.innerHTML = '';
                            updateContinueButton();
                        }
                    };
                    list.appendChild(item);
                });
            });

            input.addEventListener('keydown', function(e) {
                let items = list.querySelectorAll('.autocomplete-item');
                if (e.key === 'ArrowDown') {
                    currentFocus++;
                    addActive(items);
                } else if (e.key === 'ArrowUp') {
                    currentFocus--;
                    addActive(items);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (currentFocus > -1 && items[currentFocus]) {
                        items[currentFocus].click();
                    }
                }
            });

            function addActive(items) {
                if (!items.length) return;
                removeActive(items);
                if (currentFocus >= items.length) currentFocus = 0;
                if (currentFocus < 0) currentFocus = items.length - 1;
                items[currentFocus].classList.add('active');
                items[currentFocus].scrollIntoView({block:'nearest'});
            }
            function removeActive(items) {
                items.forEach(i => i.classList.remove('active'));
            }
            document.addEventListener('click', function(e) {
                if (e.target !== input) list.innerHTML = '';
            });
        }

        // Hand selection logic
        let selectedHand = 'Left';
        const selectedHandLabel = document.getElementById('selected-hand-label');

        function autoSelectHandFromSwing() {
            // Find the swing hand answer
            const swingInput = document.querySelector('input[name="swing-hand"]:checked');
            let swingHand = swingInput ? swingInput.value : null;
            // If user swings right, measure left; if swings left, measure right
            if (swingHand === 'Right') {
                selectedHand = 'Left';
            } else if (swingHand === 'Left') {
                selectedHand = 'Right';
            } else {
                selectedHand = 'Left'; // Default
            }
            if (selectedHandLabel) {
                selectedHandLabel.textContent = selectedHand;
            }
        }

        // Camera and photo functionality
        const cameraInput = document.getElementById('camera-input');
        const openCameraBtn = document.getElementById('open-camera-btn');
        const cameraPlaceholder = document.getElementById('camera-placeholder');
        const photoPreview = document.getElementById('photo-preview');
        const capturedImage = document.getElementById('captured-image');
        const photoActions = document.getElementById('photo-actions');
        const retakePhotoBtn = document.getElementById('retake-photo-btn');
        const confirmPhotoBtn = document.getElementById('confirm-photo-btn');

        if (openCameraBtn) {
            openCameraBtn.addEventListener('click', () => {
                cameraInput.click();
            });
        }

        if (cameraInput) {
            cameraInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        capturedImage.src = e.target.result;
                        cameraPlaceholder.style.display = 'none';
                        photoPreview.style.display = 'block';
                        photoActions.style.display = 'block';
                        openCameraBtn.style.display = 'none';
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        if (retakePhotoBtn) {
            retakePhotoBtn.addEventListener('click', () => {
                cameraPlaceholder.style.display = 'flex';
                photoPreview.style.display = 'none';
                photoActions.style.display = 'none';
                openCameraBtn.style.display = 'block';
                cameraInput.value = '';
            });
        }

        if (confirmPhotoBtn) {
            confirmPhotoBtn.addEventListener('click', () => {
                // Handle photo confirmation - could save to survey data
                console.log('Photo confirmed');
                // For now, just proceed to next page or completion
                alert('Photo captured successfully!');
            });
        }

        // Initial setup
        initProgressDots();
        showPage(currentPage);
  </script>
</body>
</html> 